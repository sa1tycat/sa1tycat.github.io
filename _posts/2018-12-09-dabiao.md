---
title: 打表
author: saltycat
date: 2018-12-09 16:28:45 +0800
categories: [技巧]
tags: [打表]
math: true
comments: true
mermaid: true
typora-root-url: ../../sa1tycat.github.io

---

# 分块打表

## [单身数](https://www.luogu.org/problemnew/show/U54177)

>dhy认为符合以下条件的数非常不吉利，会导致单身。
单身数是这样定义的： 一个数x为单生数，当且仅当这个数中数字1的个数不小于这个数位数的50%
由于dhy长期单身，所以他非常讨厌单身数。他想知道区间[l,r]之间有多少个单身数。由于dhy实在是太垃圾了，于是他把问题交给了zyc,但是这个世界总是充满了但是，zyc正忙着花式AK IOI，根本没空搭理垃圾的dhy，于是他把问题交给了聪明的你，如果你能再规定时间内给dhy正确的答案，那么zyc会奖励你10分，如果你没能完成任务,zyc会非常不开心，那么你就没分了。

>输入样例
1
1 10

>输出样例
2     //1和10

## 分块打表主要思路

1 在本机写程序打出blocklength范围内的表格(注意长度)

2 将表格输入源程序

3 分段处理，结合前置和。


于是这道题就可以这样写：

**打表程序**

```c++
#pragma GCC optimize("Ofast") //O2优化加速
#include<cstdio>
#include<cstring>
#include<algorithm>
#include<fstream>  //打表数据输入输出所需要的库
#include<cstdlib>
using namespace std;

bool judge(int x){  //判断函数 
    int count=0,length=0;
    while(x>0){
        if(x%10==1)
            count++;
        x/=10;
        length++;
    }
    if((double)count/(double)length>=0.5)return true;
    return false;
}

int main(){
    ofstream out("data.out");
    int count=0;
    int round=0;  //记录轮数
    for(int i=1;i<=2e8;++i){
        if(judge(i)){
            count++;
        }
        round++;
        if(round==100000){  //满一块(即blocklength) 
            round=0;
            out<<count<<",";
            printf("%.2lf\n",(double)i/(double)2e8); // 用于在屏幕输入输出进度
        }
    }
    out.close(); 
    return 0;
}
```

然后打出表格复制到源程序

**源程序**

```c++
#include<cstdio>
#include<cstring>
#include<cmath>
#include<algorithm>
using namespace std;
int table[200000]={1360,9506,10362,11218,12074,12930,13786,14642,15498,16354,17210,25356,26212,27068,27924,28780,29636,30492,31348,32204,32250,33106,33152,33198,33244,33290,33336,33382,33428,33474,33520,34376,34422,34468,34514,34560,34606,34652,34698,34744,34790,35646,35692,35738,35784,35830,35876,35922,35968,36014,36060,36916,36962,37008,37054,37100,37146,37192,37238,37284,37330,38186,38232,38278,38324,38370,38416,38462,38508,38554,38600,39456,39502,39548,39594,39640,39686,39732,39778,39824,39870,40726,40772,40818,40864,40910,40956,41002,41048,41094,41140,41996,42042,42088,42134,42180,42226,42272,42318,42364,43220,51366,52222,53078,53934,54790,55646,56502,57358,58214,66360,107311,115457,123603,131749,139895,148041,156187,164333,172479,173335,181481,182337,183193,184049,184905,185761,186617,187473,188329,189185,197331,198187,199043,199899,200755,201611,202467,203323,204179,205035,213181,214037,214893,215749,216605,217461,218317,219173,220029,220885,229031,229887,230743,231599,232455,233311,234167,235023,235879,236735,244881,245737,246593,247449,248305,249161,250017,250873,251729,252585,260731,261587,262443,263299,264155,265011,265867,266723,267579,268435,276581,277437,278293,279149,280005,280861,281717,282573,283429,284285,292431,293287,294143,294999,295855,296711,297567,298423,299279,299325,300181,300227,300273,300319,300365,300411,300457,300503,300549,301405,309551,310407,311263,312119,312975,313831,314687,315543,316399,316445,317301,317347,317393,317439,317485,317531,317577,317623,317669,317715,318571,318617,318663,318709,318755,318801,318847,318893,318939,318985,319841,319887,319933,319979,320025,320071,320117,320163,320209,320255,321111,321157,321203,321249,321295,321341,321387,321433,321479,321525,322381,322427,322473,322519,322565,322611,322657,322703,322749,322795,323651,323697,323743,323789,323835,323881,323927,323973,324019,324065,324921,324967,325013,325059,325105,325151,325197,325243,325289,325335,326191,326237,326283,326329,326375,326421,326467,326513,326559,326605,327461,327507,327553,327599,327645,327691,327737,327783,327829,328685,336831,337687,338543,339399,340255,341111,341967,342823,343679,343725,344581,344627,344673,344719,344765,344811,344857,344903,344949,344995,345851,345897,345943,345989,346035,346081,346127,346173,346219,346265,347121,347167,347213,347259,347305,347351,347397,347443,347489,347535,348391,348437,348483,348529,348575,348621,348667,348713,348759,348805,349661,349707,349753,349799,349845,349891,349937,349983,350029,350075,350931,350977,351023,351069,351115,351161,351207,351253,351299,351345,352201,352247,352293,352339,352385,352431,352477,352523,352569,352615,353471,353517,353563,353609,353655,353701,353747,353793,353839,353885,354741,354787,354833,354879,354925,354971,355017,355063,355109,355965,364111,364967,365823,366679,367535,368391,369247,370103,370959,371005,371861,371907,371953,371999,372045,372091,372137,372183,372229,372275,373131,373177,373223,373269,373315,373361,373407,373453,373499,373545,374401,374447,374493,374539,374585,374631,374677,374723,374769,374815,375671,375717,375763,375809,375855,375901,375947,375993,376039,376085,376941,376987,377033,377079,377125,377171,377217,377263,377309,377355,378211,378257,378303,378349,378395,378441,378487,378533,378579,378625,379481,379527,379573,379619,379665,379711,379757,379803,379849,379895,380751,380797,380843,380889,380935,380981,381027,381073,381119,381165,382021,382067,382113,382159,382205,382251,382297,382343,382389,383245,391391,392247,393103,393959,394815,395671,396527,397383,398239,398285,399141,399187,399233,399279,399325,399371,399417,399463,399509,399555,400411,400457,400503,400549,400595,400641,400687,400733,400779,400825,401681,401727,401773,401819,401865,401911,401957,402003,402049,402095,402951,402997,403043,403089,403135,403181,403227,403273,403319,403365,404221,404267,404313,404359,404405,404451,404497,404543,404589,404635,405491,405537,405583,405629,405675,405721,405767,405813,405859,405905,406761,406807,406853,406899,406945,406991,407037,407083,407129,407175,408031,408077,408123,408169,408215,408261,408307,408353,408399,408445,409301,409347,409393,409439,409485,409531,409577,409623,409669,410525,418671,419527,420383,421239,422095,422951,423807,424663,425519,425565,426421,426467,426513,426559,426605,426651,426697,426743,426789,426835,427691,427737,427783,427829,427875,427921,427967,428013,428059,428105,428961,429007,429053,429099,429145,429191,429237,429283,429329,429375,430231,430277,430323,430369,430415,430461,430507,430553,430599,430645,431501,431547,431593,431639,431685,431731,431777,431823,431869,431915,432771,432817,432863,432909,432955,433001,433047,433093,433139,433185,434041,434087,434133,434179,434225,434271,434317,434363,434409,434455,435311,435357,435403,435449,435495,435541,435587,435633,435679,435725,436581,436627,436673,436719,436765,436811,436857,436903,436949,437805,445951,446807,447663,448519,449375,450231,451087,451943,452799,452845,453701,453747,453793,453839,453885,453931,453977,454023,454069,454115,454971,455017,455063,455109,455155,455201,455247,455293,455339,455385,456241,456287,456333,456379,456425,456471,456517,456563,456609,456655,457511,457557,457603,457649,457695,457741,457787,457833,457879,457925,458781,458827,458873,458919,458965,459011,459057,459103,459149,459195,460051,460097,460143,460189,460235,460281,460327,460373,460419,460465,461321,461367,461413,461459,461505,461551,461597,461643,461689,461735,462591,462637,462683,462729,462775,462821,462867,462913,462959,463005,463861,463907,463953,463999,464045,464091,464137,464183,464229,465085,473231,474087,474943,475799,476655,477511,478367,479223,480079,480125,480981,481027,481073,481119,481165,481211,481257,481303,481349,481395,482251,482297,482343,482389,482435,482481,482527,482573,482619,482665,483521,483567,483613,483659,483705,483751,483797,483843,483889,483935,484791,484837,484883,484929,484975,485021,485067,485113,485159,485205,486061,486107,486153,486199,486245,486291,486337,486383,486429,486475,487331,487377,487423,487469,487515,487561,487607,487653,487699,487745,488601,488647,488693,488739,488785,488831,488877,488923,488969,489015,489871,489917,489963,490009,490055,490101,490147,490193,490239,490285,491141,491187,491233,491279,491325,491371,491417,491463,491509,492365,500511,501367,502223,503079,503935,504791,505647,506503,507359,507405,508261,508307,508353,508399,508445,508491,508537,508583,508629,508675,509531,509577,509623,509669,509715,509761,509807,509853,509899,509945,510801,510847,510893,510939,510985,511031,511077,511123,511169,511215,512071,512117,512163,512209,512255,512301,512347,512393,512439,512485,513341,513387,513433,513479,513525,513571,513617,513663,513709,513755,514611,514657,514703,514749,514795,514841,514887,514933,514979,515025,515881,515927,515973,516019,516065,516111,516157,516203,516249,516295,517151,517197,517243,517289,517335,517381,517427,517473,517519,517565,518421,518467,518513,518559,518605,518651,518697,518743,518789,519645,527791,528647,529503,530359,531215,532071,532927,533783,534639,534685,535541,535587,535633,535679,535725,535771,535817,535863,535909,535955,536811,536857,536903,536949,536995,537041,537087,537133,537179,537225,538081,538127,538173,538219,538265,538311,538357,538403,538449,538495,539351,539397,539443,539489,539535,539581,539627,539673,539719,539765,540621,540667,540713,540759,540805,540851,540897,540943,540989,541035,541891,541937,541983,542029,542075,542121,542167,542213,542259,542305,543161,543207,543253,543299,543345,543391,543437,543483,543529,543575,544431,544477,544523,544569,544615,544661,544707,544753,544799,545655,553801,554657,555513,556369,557225,558081,558937,559793,560649,568795,609746,617892,626038,634184,642330,650476,658622,666768,674914,675770,683916,684772,685628,686484,687340,688196,689052,689908,690764,691620,699766,700622,701478,702334,703190,704046,704902,705758,706614,707470,715616,716472,717328,718184,719040,719896,720752,721608,722464,723320,731466,732322,733178,734034,734890,735746,736602,737458,738314,739170,747316,748172,749028,749884,750740,751596,752452,753308,754164,755020,763166,764022,764878,765734,766590,767446,768302,769158,770014,770870,779016,779872,780728,781584,782440,783296,784152,785008,785864,786720,794866,795722,796578,797434,798290,799146,800002,800858,801714,801760,802616,802662,802708,802754,802800,802846,802892,802938,802984,803840,811986,812842,813698,814554,815410,816266,817122,817978,818834,818880,819736,819782,819828,819874,819920,819966,820012,820058,820104,820150,821006,821052,821098,821144,821190,821236,821282,821328,821374,821420,822276,822322,822368,822414,822460,822506,822552,822598,822644,822690,823546,823592,823638,823684,823730,823776,823822,823868,823914,823960,824816,824862,824908,824954,825000,825046,825092,825138,825184,825230,826086,826132,826178,826224,826270,826316,826362,826408,826454,826500,827356,827402,827448,827494,827540,827586,827632,827678,827724,827770,828626,828672,828718,828764,828810,828856,828902,828948,828994,829040,829896,829942,829988,830034,830080,830126,830172,830218,830264,831120,839266,840122,840978,841834,842690,843546,844402,845258,846114,846160,847016,847062,847108,847154,847200,847246,847292,847338,847384,847430,848286,848332,848378,848424,848470,848516,848562,848608,848654,848700,849556,849602,849648,849694,849740,849786,849832,849878,849924,849970,850826,850872,850918,850964,851010,851056,851102,851148,851194,851240,852096,852142,852188,852234,852280,852326,852372,852418,852464,852510,853366,853412,853458,853504,853550,853596,853642,853688,853734,853780,854636,854682,854728,854774,854820,854866,854912,854958,855004,855050,855906,855952,855998,856044,856090,856136,856182,856228,856274,856320,857176,857222,857268,857314,857360,857406,857452,857498,857544,858400,866546,867402,868258,869114,869970,870826,871682,872538,873394,873440,874296,874342,874388,874434,874480,874526,874572,874618,874664,874710,875566,875612,875658,875704,875750,875796,875842,875888,875934,875980,876836,876882,876928,876974,877020,877066,877112,877158,877204,877250,878106,878152,878198,878244,878290,878336,878382,878428,878474,878520,879376,879422,879468,879514,879560,879606,879652,879698,879744,879790,880646,880692,880738,880784,880830,880876,880922,880968,881014,881060,881916,881962,882008,882054,882100,882146,882192,882238,882284,882330,883186,883232,883278,883324,883370,883416,883462,883508,883554,883600,884456,884502,884548,884594,884640,884686,884732,884778,884824,885680,893826,894682,895538,896394,897250,898106,898962,899818,900674,900720,901576,901622,901668,901714,901760,901806,901852,901898,901944,901990,902846,902892,902938,902984,903030,903076,903122,903168,903214,903260,904116,904162,904208,904254,904300,904346,904392,904438,904484,904530,905386,905432,905478,905524,905570,905616,905662,905708,905754,905800,906656,906702,906748,906794,906840,906886,906932,906978,907024,907070,907926,907972,908018,908064,908110,908156,908202,908248,908294,908340,909196,909242,909288,909334,909380,909426,909472,909518,909564,909610,910466,910512,910558,910604,910650,910696,910742,910788,910834,910880,911736,911782,911828,911874,911920,911966,912012,912058,912104,912960,921106,921962,922818,923674,924530,925386,926242,927098,927954,928000,928856,928902,928948,928994,929040,929086,929132,929178,929224,929270,930126,930172,930218,930264,930310,930356,930402,930448,930494,930540,931396,931442,931488,931534,931580,931626,931672,931718,931764,931810,932666,932712,932758,932804,932850,932896,932942,932988,933034,933080,933936,933982,934028,934074,934120,934166,934212,934258,934304,934350,935206,935252,935298,935344,935390,935436,935482,935528,935574,935620,936476,936522,936568,936614,936660,936706,936752,936798,936844,936890,937746,937792,937838,937884,937930,937976,938022,938068,938114,938160,939016,939062,939108,939154,939200,939246,939292,939338,939384,940240,948386,949242,950098,950954,951810,952666,953522,954378,955234,955280,956136,956182,956228,956274,956320,956366,956412,956458,956504,956550,957406,957452,957498,957544,957590,957636,957682,957728,957774,957820,958676,958722,958768,958814,958860,958906,958952,958998,959044,959090,959946,959992,960038,960084,960130,960176,960222,960268,960314,960360,961216,961262,961308,961354,961400,961446,961492,961538,961584,961630,962486,962532,962578,962624,962670,962716,962762,962808,962854,962900,963756,963802,963848,963894,963940,963986,964032,964078,964124,964170,965026,965072,965118,965164,965210,965256,965302,965348,965394,965440,966296,966342,966388,966434,966480,966526,966572,966618,966664,967520,975666,976522,977378,978234,979090,979946,980802,981658,982514,982560,983416,983462,983508,983554,983600,983646,983692,983738,983784,983830,984686,984732,984778,984824,984870,984916,984962,985008,985054,985100,985956,986002,986048,986094,986140,986186,986232,986278,986324,986370,987226,987272,987318,987364,987410,987456,987502,987548,987594,987640,988496,988542,988588,988634,988680,988726,988772,988818,988864,988910,989766,989812,989858,989904,989950,989996,990042,990088,990134,990180,991036,991082,991128,991174,991220,991266,991312,991358,991404,991450,992306,992352,992398,992444,992490,992536,992582,992628,992674,992720,993576,993622,993668,993714,993760,993806,993852,993898,993944,994800,1002946,1003802,1004658,1005514,1006370,1007226,1008082,1008938,1009794,1009840,1010696,1010742,1010788,1010834,1010880,1010926,1010972,1011018,1011064,1011110,1011966,1012012,1012058,1012104,1012150,1012196,1012242,1012288,1012334,1012380,1013236,1013282,1013328,1013374,1013420,1013466,1013512,1013558,1013604,1013650,1014506,1014552,1014598,1014644,1014690,1014736,1014782,1014828,1014874,1014920,1015776,1015822,1015868,1015914,1015960,1016006,1016052,1016098,1016144,1016190,1017046,1017092,1017138,1017184,1017230,1017276,1017322,1017368,1017414,1017460,1018316,1018362,1018408,1018454,1018500,1018546,1018592,1018638,1018684,1018730,1019586,1019632,1019678,1019724,1019770,1019816,1019862,1019908,1019954};  //打出的表格，记得删掉最后一个逗号
int blockLength=100000;  //与打表程序一致 
bool judge(int x){  //判断函数，与打表程序一致
    int count=0,length=0;
    while(x>0){
        if(x%10==1)
            count++;
        x/=10;
        length++;
    }
    if((double)count/(double)length>=0.5)return true;
    return false;
}

int solve(int l,int r){
    int tl=l/blockLength;
    int tr=r/blockLength;
    // 其实这个<=1的判断都不需要，后面也要计算，但是dhy大佬还是写了
    if(tr-tl<=1){  // 范围差距小 
        int count=0;
        for(int i=l;i<=r;++i){
            if(judge(i))
                count++;
        }
        return count;
    }
    else{
        int up=tr;
        int down=tl;
        int sum1=0,sum2=0;  // 前置和
        for(int i=down*blockLength+1;i<=l-1;++i){
            if(judge(i))
            sum1++;
        }
        if(l>=blockLength)
        sum1+=table[down-1]; //-1是因为从0计数
        for(int i=up*blockLength+1;i<=r;++i)
            if(judge(i))
            sum2++;
        sum2+=table[up-1];
        return sum2-sum1;
    }
}

int main(){
    int n,a,b;
    scanf("%d",&n);
    for(int i=1;i<=n;++i){
        scanf("%d%d",&a,&b);
        printf("%d\n",solve(a,b));
    }
    return 0;
}
```

dhy大佬手稿

![大佬手稿](/assets/img/2018-12-09-dabiao/22-03-30-14-25-38.png)
